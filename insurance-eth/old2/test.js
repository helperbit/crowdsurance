/* 
 *  Helperbit: a p2p donation platform (crowdsurance)
 *  Copyright (C) 2016-2021  Davide Gessa (gessadavide@gmail.com)
 *  
 *  This program is free software: you can redistribute it and/or modify
 *  it under the terms of the GNU General Public License as published by
 *  the Free Software Foundation, either version 3 of the License, or
 *  (at your option) any later version.
 *  
 *  This program is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *  GNU General Public License for more details.
 *  
 *  You should have received a copy of the GNU General Public License
 *  along with this program.  If not, see <https://www.gnu.org/licenses/>
 */

var TestRPC = require("ethereumjs-testrpc");

web3.setProvider(TestRPC.provider());

var insurbitContract = web3.eth.contract([{"constant":true,"inputs":[],"name":"SPLIT_SHORT_TERM","outputs":[{"name":"","type":"uint256"}],"payable":false,"type":"function"},{"constant":true,"inputs":[],"name":"SPLIT_LONG_TERM","outputs":[{"name":"","type":"uint256"}],"payable":false,"type":"function"},{"constant":true,"inputs":[{"name":"","type":"uint32"}],"name":"events","outputs":[{"name":"eventType","type":"uint8"},{"name":"intensity","type":"uint32"},{"name":"distributed","type":"uint256"},{"name":"users","type":"uint32"}],"payable":false,"type":"function"},{"constant":true,"inputs":[{"name":"","type":"uint32"}],"name":"world","outputs":[{"name":"usercount","type":"uint32"},{"name":"intensity","type":"uint32"}],"payable":false,"type":"function"},{"constant":true,"inputs":[],"name":"totalInsuredAmountShortTerm","outputs":[{"name":"","type":"uint256"}],"payable":false,"type":"function"},{"constant":false,"inputs":[],"name":"endInsuringPeriod","outputs":[],"payable":false,"type":"function"},{"constant":true,"inputs":[],"name":"totalInsuredAmount","outputs":[{"name":"","type":"uint256"}],"payable":false,"type":"function"},{"constant":true,"inputs":[],"name":"YEAR_INTENSITY","outputs":[{"name":"","type":"uint256"}],"payable":false,"type":"function"},{"constant":false,"inputs":[],"name":"raiseLongTermReward","outputs":[],"payable":false,"type":"function"},{"constant":true,"inputs":[],"name":"intensitySum","outputs":[{"name":"","type":"uint32"}],"payable":false,"type":"function"},{"constant":true,"inputs":[],"name":"HELPERBIT_ADDRESS","outputs":[{"name":"","type":"address"}],"payable":false,"type":"function"},{"constant":true,"inputs":[],"name":"totalInsuredAmountLongTerm","outputs":[{"name":"","type":"uint256"}],"payable":false,"type":"function"},{"constant":true,"inputs":[],"name":"insuringPeriodActive","outputs":[{"name":"","type":"bool"}],"payable":false,"type":"function"},{"constant":true,"inputs":[],"name":"totalEvents","outputs":[{"name":"","type":"uint32"}],"payable":false,"type":"function"},{"constant":true,"inputs":[],"name":"totalUsers","outputs":[{"name":"","type":"uint32"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"eventType","type":"uint8"},{"name":"cells","type":"uint32[]"},{"name":"intensity","type":"uint16"}],"name":"raiseEvent","outputs":[],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"cell","type":"uint32"},{"name":"user","type":"address"}],"name":"insure","outputs":[],"payable":false,"type":"function"},{"inputs":[],"payable":false,"type":"constructor"},{"anonymous":false,"inputs":[{"indexed":false,"name":"totalInsuredAmount","type":"uint256"},{"indexed":false,"name":"totalUsers","type":"uint32"}],"name":"InsuringPeriodEnd","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"eventType","type":"uint8"},{"indexed":false,"name":"intensity","type":"uint32"},{"indexed":false,"name":"cells","type":"uint32[]"},{"indexed":false,"name":"distributed","type":"uint256"},{"indexed":false,"name":"affected","type":"uint32"}],"name":"RaisedEvent","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"distributed","type":"uint256"},{"indexed":false,"name":"affected","type":"uint256"}],"name":"LongTermDistribution","type":"event"}]);
var insurbit = insurbitContract.new(
   {
     from: web3.eth.accounts[0], 
     data: '0x606060405234610000575b6007805461a80560085560646009556000600a8190556003805463ffffffff199081169091558180556001829055600291909155600580549091169055640100000000602860020a60c860020a0319909116650100000000006c0100000000000000000000000033810204021764ffffffffff19161790555b5b610bfa806100926000396000f3606060405236156100cf5760e060020a60003504630744fb0381146100d45780630e48617c146100f35780631472d53f1461011257806318b95c18146101615780632192e7c81461019a57806338c2422b146101b95780635884bc03146101c8578063694e9419146101e757806371efe927146102065780639e06fda814610215578063a834da141461023b578063aa5e430314610264578063b876dec614610283578063ba870686146102a4578063bff1f9e1146102ca578063e630bcf0146102f0578063f263a49414610342575b610000565b34610000576100e1610357565b60408051918252519081900360200190f35b34610000576100e161035d565b60408051918252519081900360200190f35b3461000057610122600435610363565b6040518085600081116100005781526020018463ffffffff1681526020018381526020018263ffffffff16815260200194505050505060405180910390f35b3461000057610171600435610397565b604051808363ffffffff1681526020018263ffffffff1681526020019250505060405180910390f35b34610000576100e16103ba565b60408051918252519081900360200190f35b34610000576101c66103c0565b005b34610000576100e161043c565b60408051918252519081900360200190f35b34610000576100e1610442565b60408051918252519081900360200190f35b34610000576101c6610448565b005b34610000576102226104ab565b6040805163ffffffff9092168252519081900360200190f35b34610000576102486104b7565b60408051600160a060020a039092168252519081900360200190f35b34610000576100e16104cf565b60408051918252519081900360200190f35b34610000576102906104d5565b604080519115158252519081900360200190f35b34610000576102226104e6565b6040805163ffffffff9092168252519081900360200190f35b34610000576102226104f2565b6040805163ffffffff9092168252519081900360200190f35b34610000576040805160248035600481810135602081810286810182019097528186526101c69683359693956044950192918291908501908490808284375094965050933593506104fe92505050565b005b34610000576101c66004356024356109d6565b005b60095481565b600a5481565b60066020526000908152604090208054600282015460039092015460ff82169263ffffffff61010090930483169290911684565b6004602052600090815260409020805460029091015463ffffffff918216911682565b60015481565b60075433600160a060020a039081166501000000000090920416146103e457610000565b6007805464ff00000000191690556000546003546040805192835263ffffffff909116602083015280517fa9e8b0aa5a5dc979a350d2de77d68547c3ed1b368504827e023a90db1af7ff7b9281900390910190a15b5b565b60005481565b60085481565b60075433600160a060020a0390811665010000000000909204161461046c57610000565b604080516000808252602082015281517f25fba8ca02a8143ccdb6e384d21ba35e7f2c37ad2ac908b48d231415c6ee2749929181900390910190a15b5b565b60075463ffffffff1681565b600754650100000000009004600160a060020a031681565b60025481565b600754640100000000900460ff1681565b60055463ffffffff1681565b60035463ffffffff1681565b6000600060006000600060006000600760059054906101000a9004600160a060020a0316600160a060020a031633600160a060020a031614151561054157610000565b60009650600095505b88518610156105d8578886815181101561000057906020019060200201519350600094505b63ffffffff808516865260046020526040862054168510156105cc5763ffffffff8085166000908152600460209081526040808320938916835260019384019091529020810154979097019692909201915b60019094019361056f565b5b60019095019461054a565b6001546008548961ffff1681156100005704029150600095505b8851861015610717578886815181101561000057906020019060200201519350600094505b63ffffffff808516865260046020526040862054168510156106cc5763ffffffff808516600090815260046020908152604080832093891683526001938401909152902001548281156100005763ffffffff8087166000908152600460209081526040808320938b16835260019093019052818120549151939092049350600160a060020a03169183156108fc0291849190818181858888f1935050505015156106c057610000565b5b600190940193610617565b63ffffffff8085166000908152600460205260409020600201805460e060020a92811661ffff8c160183029290920463ffffffff199092169190911790555b600195909501946105f2565b8761ffff16600760008282829054906101000a900463ffffffff160192506101000a81548163ffffffff021916908360e060020a90810204021790555060a0604051908101604052808b81526020018961ffff1681526020018a81526020018381526020018481526020015060066000600560009054906101000a900463ffffffff1663ffffffff16815260200190815260200160002060008201518160000160006101000a81548160ff021916908360f860020a90810204021790555060208201518160000160016101000a81548163ffffffff021916908360e060020a9081020402179055506040820151816001019080519060200190828054828255906000526020600020906007016008900481019282156108b25791602002820160005b8382111561088057835183826101000a81548163ffffffff021916908360e060020a9081020402179055509260200192600401602081600301049283019260010302610839565b80156108b05782816101000a81549063ffffffff0219169055600401602081600301049283019260010302610880565b505b506108d99291505b808211156108d557805463ffffffff191681556001016108ba565b5090565b5050606082015160028201556080909101516003909101805463ffffffff1990811660e060020a938402849004179091556005805491821663ffffffff9092166001018302929092041790556040517f36f4c29d492e0042739706caabab8d06f510d3917fd72f7d7f3dd0dd902205ca908b908a908c90869088908086600081116100005781526020018561ffff168152602001806020018481526020018363ffffffff1681526020018281038252858181518152602001915080519060200190602002808383829060006004602084601f0104600302600f01f150905001965050505050505060405180910390a15b5b50505050505050505050565b60075433600160a060020a039081166501000000000090920416146109fa57610000565b600754640100000000900460ff161515610a1357610000565b60008054349081019091556009549081156100005760018054929091046064029091019055600a5434811561000057600280549290910460640290910190556003805463ffffffff19811660e060020a63ffffffff92831660010181020417909155828116600090815260046020526040902054161515610ae4576040805180820182526000808252602080830182815263ffffffff8716835260049091529290209051815463ffffffff1990811660e060020a928302839004178355925160029092018054909316918102041790555b60406040519081016040528082815260200134815260200150600460008463ffffffff1681526020019081526020016000206001016000600460008663ffffffff16815260200190815260200160002060000160009054906101000a900463ffffffff1663ffffffff16815260200190815260200160002060008201518160000160006101000a815481600160a060020a0302191690836c01000000000000000000000000908102040217905550602082015181600101559050506001600460008463ffffffff16815260200190815260200160002060000160008282829054906101000a900463ffffffff160192506101000a81548163ffffffff021916908360e060020a9081020402179055505b5b5b505056', 
     gas: '4700000'
   }, function (e, contract){
    console.log(e, contract);
    if (typeof contract.address !== 'undefined') {
         console.log('Contract mined! address: ' + contract.address + ' transactionHash: ' + contract.transactionHash);
    }
 });